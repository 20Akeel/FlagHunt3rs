<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leaderboard - Flag Hunt3rs</title>
  <link rel="stylesheet" href="style.css">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

</head>

<body>
  <!-- Authenticated User Navigation -->
  <nav class="navbar">
  <div class="nav-container">
    <div class="nav-logo">
      <h2>Flag Hunt3rs</h2>
    </div>
    <div class="nav-menu">
      <a href="index.html" class="nav-link">Home</a>
      <a href="challenge.html" class="nav-link">Challenges</a>
      <a href="javascript:void(0)" onclick="showLeaderboard()" class="nav-link active">Leaderboard</a>
      <a href="about-developers.html" class="nav-link">About Developer</a>
      <a href="javascript:void(0)" onclick="showProfile()" class="nav-link">Profile</a>
      <a href="javascript:void(0)" onclick="signOut()" class="nav-link">Sign Out</a>
    </div>
  </div>
</nav>

  <div class="container" style="padding-top: 100px;">
    <header>
      <h1>Leaderboard</h1>
      <p>See how you stack up against fellow ethical hackers. Rankings are based on challenges solved and points earned.</p>
    </header>

    <!-- Leaderboard Statistics -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">ðŸ‘¥</div>
        <div class="stat-info">
          <h3 id="totalUsers">0</h3>
          <p>Total Hackers</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ðŸŽ¯</div>
        <div class="stat-info">
          <h3 id="totalChallenges">7</h3>
          <p>Total Challenges</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">âœ…</div>
        <div class="stat-info">
          <h3 id="totalSolved">0</h3>
          <p>Challenges Solved</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">ðŸ”¥</div>
        <div class="stat-info">
          <h3 id="topScore">0</h3>
          <p>Highest Score</p>
        </div>
      </div>
    </div>

    <!-- Filter Options -->
    <div class="filter-section">
      <div class="filter-buttons">
        <button class="filter-btn active" onclick="filterLeaderboard('all')">All Challenges</button>
        <button class="filter-btn" onclick="filterLeaderboard('easy')">Easy</button>
        <button class="filter-btn" onclick="filterLeaderboard('medium')">Medium</button>
        <button class="filter-btn" onclick="filterLeaderboard('hard')">Hard</button>
      </div>
      <div class="sort-options">
        <label for="sortBy">Sort by:</label>
        <select id="sortBy" onchange="updateLeaderboard()">
          <option value="score">Total Score</option>
          <option value="challenges">Challenges Solved</option>
          <option value="recent">Most Recent Activity</option>
          <option value="name">Name (A-Z)</option>
        </select>
      </div>
    </div>

    <!-- Leaderboard Table -->
    <div class="leaderboard-container">
      <div class="leaderboard-header">
        <h2>Rankings</h2>
        <div class="refresh-btn" onclick="updateLeaderboard()">
          <span>Refresh</span> 
        </div>
      </div>

      <div class="leaderboard-table">
        <div class="table-header">
          <div class="rank-col">Rank</div>
          <div class="user-col">User</div>
          <div class="score-col">Score</div>
          <div class="challenges-col">Solved</div>
          <div class="activity-col">Last Activity</div>
          <div class="details-col">Details</div>
        </div>
        <div id="leaderboardBody" class="table-body">
          <!-- Dynamic content will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Recent Activities -->
    <div class="recent-activities">
      <h2>Recent Activities</h2>
      <div id="recentActivitiesList" class="activities-list">
        <!-- Dynamic content will be loaded here -->
      </div>
    </div>

    <!-- Challenge Progress Overview -->
    <div class="progress-overview">
      <h2>Challenge Progress Overview</h2>
      <div class="progress-grid">
        <div class="progress-card easy">
          <h3>ðŸŸ¢ Easy Challenges</h3>
          <div class="progress-bar">
            <div class="progress-fill" id="easyProgress"></div>
          </div>
          <div class="progress-stats">
            <span id="easySolved">0</span> / <span id="easyTotal">2</span> completed
          </div>
        </div>
        <div class="progress-card medium">
          <h3>ðŸŸ¡ Medium Challenges</h3>
          <div class="progress-bar">
            <div class="progress-fill" id="mediumProgress"></div>
          </div>
          <div class="progress-stats">
            <span id="mediumSolved">0</span> / <span id="mediumTotal">3</span> completed
          </div>
        </div>
        <div class="progress-card hard">
          <h3>ðŸ”´ Hard Challenges</h3>
          <div class="progress-bar">
            <div class="progress-fill" id="hardProgress"></div>
          </div>
          <div class="progress-stats">
            <span id="hardSolved">0</span> / <span id="hardTotal">2</span> completed
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- User Details Modal -->
  <div id="userDetailsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>User Details</h3>
        <span class="close" onclick="closeModal('userDetailsModal')">&times;</span>
      </div>
      <div class="modal-body">
        <div id="userDetailsContent">
          <!-- Dynamic content will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <script>

// Global variables
let currentUser = null;
let currentFilter = 'all';
let currentSort = 'score';

// Challenge points mapping
const challengePoints = {
  'easy-1': 100,
  'easy-2': 150,
  'medium-1': 200,
  'medium-2': 250,
  'medium-3': 300,
  'hard-1': 400,
  'hard-2': 500
};

// Challenge names mapping
const challengeNames = {
  'easy-1': 'Logic Flaw Exploitation',
  'easy-2': 'Base64 Decoding',
  'medium-1': 'Hidden JavaScript Function',
  'medium-2': 'SQL Injection Basics',
  'medium-3': 'Cookie Manipulation',
  'hard-1': 'Cross-Site Scripting (XSS)',
  'hard-2': 'Advanced Authentication Bypass'
};

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
  console.log('Leaderboard page loaded'); // Debug log
  
  // Check authentication with backend instead of localStorage
  checkAuthStatus();
});

// NEW: Check authentication status with backend
async function checkAuthStatus() {
  try {
    const response = await fetch('/auth/status');
    const data = await response.json();
    
    if (data.loggedIn) {
      currentUser = { 
        name: data.username,
        username: data.username,
        id: data.userId || data.username
      };
      
      console.log('Current user:', currentUser); // Debug log
      
      // Load leaderboard data with delay to ensure DOM is ready
      setTimeout(() => {
        updateLeaderboard();
        updateStatistics();
        loadRecentActivities();
        updateProgressOverview();
      }, 100);
    } else {
      // Not authenticated, redirect to login
      window.location.href = 'index.html';
      return;
    }
  } catch (error) {
    console.error('Error checking auth status:', error);
    // Fallback to redirect if can't check auth
    window.location.href = 'index.html';
  }
}

// Updated: Fetch users data from backend
async function fetchUsersData() {
  try {
    const response = await fetch('/auth/users'); // You'll need to create this endpoint
    if (response.ok) {
      const data = await response.json();
      return data.users || [];
    }
  } catch (error) {
    console.error('Error fetching users from backend:', error);
  }
  
  // Fallback to localStorage if backend is not available
  return JSON.parse(localStorage.getItem('users') || '[]');
}

// Updated: Update leaderboard
async function updateLeaderboard() {
  console.log('Updating leaderboard...'); // Debug log
  const users = await fetchUsersData();
  console.log('Users data:', users); // Debug log
  
  const sortBy = document.getElementById('sortBy') ? document.getElementById('sortBy').value : 'score';
  currentSort = sortBy;
  
  // Calculate scores and filter users
  const processedUsers = users.map(user => {
    const solvedChallenges = user.solvedChallenges || [];
    console.log(`User ${user.username || user.name} solved challenges:`, solvedChallenges); // Debug log
    
    const totalScore = solvedChallenges.reduce((sum, challenge) => {
      const earned = (typeof challenge.points === 'number')
        ? challenge.points
        : (challengePoints[challenge.challengeId] || 0);
      return sum + earned;
    }, 0);
    
    const challengesByDifficulty = {
      easy: solvedChallenges.filter(c => c.challengeId && c.challengeId.startsWith('easy')),
      medium: solvedChallenges.filter(c => c.challengeId && c.challengeId.startsWith('medium')),
      hard: solvedChallenges.filter(c => c.challengeId && c.challengeId.startsWith('hard'))
    };
    
    const lastActivityTime = solvedChallenges.length > 0 ? 
      Math.max(...solvedChallenges.map(c => {
        const timestamp = c.timestamp || c.dateTime;
        return timestamp ? new Date(timestamp).getTime() : new Date(user.joinDate).getTime();
      })) : 
      new Date(user.joinDate || Date.now()).getTime();
    
    return {
      ...user,
      name: user.username || user.name, // Ensure we have a name field
      totalScore,
      totalSolved: solvedChallenges.length,
      challengesByDifficulty,
      lastActivity: lastActivityTime
    };
  });

  console.log('Processed users:', processedUsers); // Debug log

  // Sort users
  processedUsers.sort((a, b) => {
    switch (sortBy) {
      case 'score':
        return b.totalScore - a.totalScore || b.totalSolved - a.totalSolved;
      case 'challenges':
        return b.totalSolved - a.totalSolved || b.totalScore - a.totalScore;
      case 'recent':
        return b.lastActivity - a.lastActivity;
      case 'name':
        return (a.name || '').localeCompare(b.name || '');
      default:
        return b.totalScore - a.totalScore;
    }
  });

  // Filter by difficulty if needed
  let filteredUsers = processedUsers;
  if (currentFilter !== 'all') {
    filteredUsers = processedUsers.filter(user => 
      user.challengesByDifficulty[currentFilter] && user.challengesByDifficulty[currentFilter].length > 0
    );
  }

  // Render leaderboard
  renderLeaderboard(filteredUsers);
}

// Render leaderboard table
function renderLeaderboard(users) {
  const tbody = document.getElementById('leaderboardBody');
  if (!tbody) {
    console.error('Leaderboard body element not found'); // Debug log
    return;
  }
  
  tbody.innerHTML = '';
  console.log('Rendering users:', users); // Debug log

  if (users.length === 0) {
    tbody.innerHTML = `
      <div class="no-data">
        <p>No users found for the selected filter.</p>
      </div>
    `;
    return;
  }

  users.forEach((user, index) => {
    const rank = index + 1;
    const isCurrentUser = currentUser && (user.id === currentUser.id || user.username === currentUser.username);
    
    const row = document.createElement('div');
    row.className = `table-row ${isCurrentUser ? 'current-user' : ''}`;
    
    row.innerHTML = `
      <div class="rank-col">
        <span class="rank-badge ${getRankClass(rank)}">${rank}</span>
      </div>
      <div class="user-col">
        <div class="user-info">
          <div class="user-avatar">${(user.name || 'U').charAt(0).toUpperCase()}</div>
          <div class="user-details">
            <div class="user-name">${user.name || 'Unknown'} ${isCurrentUser ? '(You)' : ''}</div>
            <div class="join-date">Joined ${formatDate(user.joinDate || Date.now())}</div>
          </div>
        </div>
      </div>
      <div class="score-col">
        <span class="score">${user.totalScore}</span>
        <span class="points-label">pts</span>
      </div>
      <div class="challenges-col">
        <div class="challenge-breakdown">
          <span class="total-solved">${user.totalSolved}/7</span>
          <div class="difficulty-badges">
            <span class="diff-badge easy">${user.challengesByDifficulty.easy.length}</span>
            <span class="diff-badge medium">${user.challengesByDifficulty.medium.length}</span>
            <span class="diff-badge hard">${user.challengesByDifficulty.hard.length}</span>
          </div>
        </div>
      </div>
      <div class="activity-col">
        <span class="last-activity">${formatTimeAgo(user.lastActivity)}</span>
      </div>
      <div class="details-col">
        <button class="btn-details" onclick="showUserDetails('${user.id || user.username}')">View</button>
      </div>
    `;
    
    tbody.appendChild(row);
  });
}

// Updated: Update statistics
async function updateStatistics() {
  console.log('Updating statistics...'); // Debug log
  const users = await fetchUsersData();
  
  let totalSolved = 0;
  let topScore = 0;
  
  users.forEach(user => {
    const solvedChallenges = user.solvedChallenges || [];
    totalSolved += solvedChallenges.length;
    
    const userScore = solvedChallenges.reduce((sum, challenge) => {
      const earned = (typeof challenge.points === 'number')
        ? challenge.points
        : (challengePoints[challenge.challengeId] || 0);
      return sum + earned;
    }, 0);
    
    if (userScore > topScore) {
      topScore = userScore;
    }
  });
  
  console.log('Statistics:', { totalUsers: users.length, totalSolved, topScore }); // Debug log
  
  // Update DOM elements with safety checks
  const totalUsersEl = document.getElementById('totalUsers');
  const totalSolvedEl = document.getElementById('totalSolved');
  const topScoreEl = document.getElementById('topScore');
  
  if (totalUsersEl) totalUsersEl.textContent = users.length;
  if (totalSolvedEl) totalSolvedEl.textContent = totalSolved;
  if (topScoreEl) topScoreEl.textContent = topScore;
}

// Updated: Load recent activities
async function loadRecentActivities() {
  console.log('Loading recent activities...'); // Debug log
  const users = await fetchUsersData();
  const allActivities = [];
  
  users.forEach(user => {
    const solvedChallenges = user.solvedChallenges || [];
    solvedChallenges.forEach(challenge => {
      if (challenge.challengeId && challengeNames[challenge.challengeId]) {
        allActivities.push({
          userName: user.username || user.name,
          challengeId: challenge.challengeId,
          challengeName: challengeNames[challenge.challengeId],
          timestamp: challenge.timestamp || challenge.dateTime || new Date().toISOString(),
          dateTime: challenge.dateTime || new Date(challenge.timestamp || Date.now()).toLocaleString(),
          points: (typeof challenge.points === 'number')
            ? challenge.points
            : (challengePoints[challenge.challengeId] || 0)
        });
      }
    });
  });
  
  console.log('All activities:', allActivities); // Debug log
  
  // Sort by timestamp (most recent first)
  allActivities.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
  
  // Take only the 10 most recent
  const recentActivities = allActivities.slice(0, 10);
  
  const activitiesList = document.getElementById('recentActivitiesList');
  if (!activitiesList) {
    console.error('Recent activities list element not found');
    return;
  }
  
  activitiesList.innerHTML = '';
  
  if (recentActivities.length === 0) {
    activitiesList.innerHTML = '<p class="no-activities">No recent activities yet.</p>';
    return;
  }
  
  recentActivities.forEach(activity => {
    const activityElement = document.createElement('div');
    activityElement.className = 'activity-item';
    
    const difficultyClass = activity.challengeId.split('-')[0];
    
    activityElement.innerHTML = `
      <div class="activity-icon ${difficultyClass}">ðŸŽ¯</div>
      <div class="activity-details">
        <div class="activity-main">
          <strong>${activity.userName}</strong> solved 
          <span class="challenge-name">${activity.challengeName}</span>
        </div>
        <div class="activity-meta">
          <span class="activity-time">${formatTimeAgo(new Date(activity.timestamp).getTime())}</span> â€¢ 
          <span class="activity-points">+${activity.points} pts</span>
        </div>
      </div>
    `;
    
    activitiesList.appendChild(activityElement);
  });
}

// Updated: Update progress overview
async function updateProgressOverview() {
  console.log('Updating progress overview...'); // Debug log
  const users = await fetchUsersData();
  
  let easySolvedTotal = 0;
  let mediumSolvedTotal = 0;
  let hardSolvedTotal = 0;
  
  users.forEach(user => {
    const solvedChallenges = user.solvedChallenges || [];
    easySolvedTotal += solvedChallenges.filter(c => c.challengeId && c.challengeId.startsWith('easy')).length;
    mediumSolvedTotal += solvedChallenges.filter(c => c.challengeId && c.challengeId.startsWith('medium')).length;
    hardSolvedTotal += solvedChallenges.filter(c => c.challengeId && c.challengeId.startsWith('hard')).length;
  });
  
  const totalUsers = Math.max(users.length, 1); // Prevent division by zero
  
  console.log('Progress data:', { easySolvedTotal, mediumSolvedTotal, hardSolvedTotal, totalUsers });
  
  // Update easy progress
  const easyPercentage = (easySolvedTotal / (2 * totalUsers)) * 100;
  const easyProgressEl = document.getElementById('easyProgress');
  const easySolvedEl = document.getElementById('easySolved');
  
  if (easyProgressEl) easyProgressEl.style.width = `${Math.min(easyPercentage, 100)}%`;
  if (easySolvedEl) easySolvedEl.textContent = easySolvedTotal;
  
  // Update medium progress
  const mediumPercentage = (mediumSolvedTotal / (3 * totalUsers)) * 100;
  const mediumProgressEl = document.getElementById('mediumProgress');
  const mediumSolvedEl = document.getElementById('mediumSolved');
  
  if (mediumProgressEl) mediumProgressEl.style.width = `${Math.min(mediumPercentage, 100)}%`;
  if (mediumSolvedEl) mediumSolvedEl.textContent = mediumSolvedTotal;
  
  // Update hard progress
  const hardPercentage = (hardSolvedTotal / (2 * totalUsers)) * 100;
  const hardProgressEl = document.getElementById('hardProgress');
  const hardSolvedEl = document.getElementById('hardSolved');
  
  if (hardProgressEl) hardProgressEl.style.width = `${Math.min(hardPercentage, 100)}%`;
  if (hardSolvedEl) hardSolvedEl.textContent = hardSolvedTotal;
}

// Filter leaderboard by difficulty
function filterLeaderboard(difficulty) {
  currentFilter = difficulty;
  
  // Update active filter button
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  
  // Find and activate the clicked button
  const clickedBtn = Array.from(document.querySelectorAll('.filter-btn')).find(btn => 
    btn.textContent.trim().toLowerCase().includes(difficulty === 'all' ? 'all' : difficulty)
  );
  if (clickedBtn) clickedBtn.classList.add('active');
  
  updateLeaderboard();
}

// Updated: Show user details modal
async function showUserDetails(userId) {
  const users = await fetchUsersData();
  const user = users.find(u => u.id === userId || u.username === userId);
  
  if (!user) return;
  
  const solvedChallenges = user.solvedChallenges || [];
  const totalScore = solvedChallenges.reduce((sum, challenge) => {
    const earned = (typeof challenge.points === 'number')
      ? challenge.points
      : (challengePoints[challenge.challengeId] || 0);
    return sum + earned;
  }, 0);
  
  const modalContent = document.getElementById('userDetailsContent');
  if (!modalContent) return;
  
  modalContent.innerHTML = `
    <div class="user-profile">
      <div class="profile-header">
        <div class="profile-avatar">${(user.username || user.name || 'U').charAt(0).toUpperCase()}</div>
        <div class="profile-info">
          <h3>${user.username || user.name || 'Unknown User'}</h3>
          <p>Joined: ${formatDate(user.joinDate || Date.now())}</p>
          <p>Total Score: <strong>${totalScore} points</strong></p>
        </div>
      </div>
      
      <div class="solved-challenges">
        <h4>Solved Challenges (${solvedChallenges.length}/7)</h4>
        ${solvedChallenges.length === 0 ? 
          '<p class="no-challenges">No challenges solved yet.</p>' :
          solvedChallenges.map(challenge => `
            <div class="solved-challenge">
              <div class="challenge-info">
                <span class="challenge-title">${challengeNames[challenge.challengeId] || challenge.challengeId}</span>
                <span class="challenge-points">+${(typeof challenge.points === 'number' ? challenge.points : (challengePoints[challenge.challengeId] || 0))} pts</span>
              </div>
              <div class="challenge-timestamp">
                <span class="solved-date">${challenge.dateTime || new Date(challenge.timestamp || Date.now()).toLocaleString()}</span>
              </div>
            </div>
          `).join('')
        }
      </div>
    </div>
  `;
  
  const modal = document.getElementById('userDetailsModal');
  if (modal) modal.style.display = 'flex';
}

// Utility functions
function getRankClass(rank) {
  if (rank === 1) return 'gold';
  if (rank === 2) return 'silver';
  if (rank === 3) return 'bronze';
  return 'default';
}

function formatDate(dateString) {
  return new Date(dateString).toLocaleDateString();
}

function formatTimeAgo(timestamp) {
  const now = new Date().getTime();
  const diff = now - timestamp;
  
  const minutes = Math.floor(diff / (1000 * 60));
  const hours = Math.floor(diff / (1000 * 60 * 60));
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));
  
  if (days > 0) return `${days}d ago`;
  if (hours > 0) return `${hours}h ago`;
  if (minutes > 0) return `${minutes}m ago`;
  return 'Just now';
}

function closeModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) modal.style.display = 'none';
}

// Navigation functions
function showLeaderboard() {
  // Already on leaderboard page
}

function showProfile() {
  window.location.href = 'profile.html';
}

// Updated: Sign out function
async function signOut() {
  try {
    const response = await fetch('/auth/logout', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      }
    });

    if (response.ok) {
      currentUser = null;
      window.location.href = 'index.html';
    }
  } catch (error) {
    console.error('Error signing out:', error);
    // Fallback - just redirect
    window.location.href = 'index.html';
  }
}

// Close modals when clicking outside
window.addEventListener('click', function(e) {
  if (e.target.classList.contains('modal')) {
    e.target.style.display = 'none';
  }
});

// Add refresh functionality
window.addEventListener('focus', function() {
  // Refresh data when window gains focus
  if (typeof updateLeaderboard === 'function') {
    updateLeaderboard();
    updateStatistics();
    loadRecentActivities();
    updateProgressOverview();
  }
});
  </script>

  <style>
    /* CSS Variables */
    :root {
      --primary-green: #00ff88;
      --primary-green-dark: #00cc6a;
      --primary-green-glow: rgba(0, 255, 136, 0.3);
      --bg-primary: #0a0a0f;
      --bg-secondary: #141419;
      --bg-card: #1a1a20;
      --text-primary: #ffffff;
      --text-secondary: #b0b3b8;
      --text-muted: #6b7280;
      --border-color: #2a2a35;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --danger-color: #ef4444;
      --shadow-primary: 0 4px 20px rgba(0, 0, 0, 0.3);
      --shadow-glow: 0 0 30px var(--primary-green-glow);
    }
    /* Enhanced Leaderboard Styles */
    .auth-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(10, 10, 15, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border-color);
      padding: 15px 0;
      z-index: 1000;
    }

    .auth-nav-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .user-info {
      color: var(--text-primary);
      font-weight: 500;
    }

    .auth-menu {
      display: flex;
      gap: 30px;
    }

    .auth-link {
      color: var(--text-secondary);
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s ease;
    }

    .auth-link:hover, .auth-link.active {
      color: var(--primary-green);
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 40px 0;
    }

    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 25px;
      text-align: center;
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
    }

    .stat-icon {
      font-size: 2.5rem;
      margin-bottom: 15px;
    }

    .stat-info h3 {
      font-size: 2rem;
      color: var(--primary-green);
      margin-bottom: 5px;
    }

    .stat-info p {
      color: var(--text-secondary);
      margin: 0;
    }

    .filter-section {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 40px 0;
      flex-wrap: wrap;
      gap: 20px;
    }

    .filter-buttons {
      display: flex;
      gap: 10px;
    }

    .filter-btn {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-secondary);
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-btn:hover, .filter-btn.active {
      background: var(--primary-green);
      color: var(--bg-primary);
      border-color: var(--primary-green);
    }

    .sort-options {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sort-options label {
      color: var(--text-secondary);
      margin: 0;
    }

    .sort-options select {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      padding: 8px 12px;
      border-radius: 6px;
    }

    .leaderboard-container {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 40px;
    }

    .leaderboard-header {
      background: var(--bg-secondary);
      padding: 20px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--border-color);
    }

    .leaderboard-header h2 {
      margin: 0;
      color: var(--text-primary);
    }

    .refresh-btn {
      background: var(--primary-green);
      color: var(--bg-primary);
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .refresh-btn:hover {
      background: var(--primary-green-dark);
    }

    .leaderboard-table {
      width: 100%;
    }

    .table-header {
      display: grid;
      grid-template-columns: 80px 1fr 120px 150px 120px 80px;
      gap: 20px;
      padding: 20px 30px;
      background: var(--bg-secondary);
      font-weight: 600;
      color: var(--text-primary);
      border-bottom: 1px solid var(--border-color);
    }

    .table-row {
      display: grid;
      grid-template-columns: 80px 1fr 120px 150px 120px 80px;
      gap: 20px;
      padding: 20px 30px;
      border-bottom: 1px solid var(--border-color);
      transition: background 0.3s ease;
      align-items: center;
    }

    .table-row:hover {
      background: var(--bg-secondary);
    }

    .table-row.current-user {
      background: rgba(0, 255, 204, 0.05);
      border-left: 4px solid var(--primary-green);
    }

    .rank-badge {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.1rem;
    }

    .rank-badge.gold {
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      color: #000;
    }

    .rank-badge.silver {
      background: linear-gradient(135deg, #c0c0c0, #e5e5e5);
      color: #000;
    }

    .rank-badge.bronze {
      background: linear-gradient(135deg, #cd7f32, #daa520);
      color: #000;
    }

    .rank-badge.default {
      background: var(--bg-secondary);
      color: var(--text-secondary);
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: var(--primary-green);
      color: var(--bg-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.2rem;
    }

    .user-name {
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 5px;
    }

    .join-date {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .score {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-green);
    }

    .points-label {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .challenge-breakdown {
      text-align: center;
    }

    .total-solved {
      font-weight: 600;
      color: var(--text-primary);
      display: block;
      margin-bottom: 8px;
    }

    .difficulty-badges {
      display: flex;
      gap: 5px;
      justify-content: center;
    }

    .diff-badge {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .diff-badge.easy {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
    }

    .diff-badge.medium {
      background: rgba(245, 158, 11, 0.2);
      color: #f59e0b;
    }

    .diff-badge.hard {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }

    .last-activity {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .btn-details {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-secondary);
      padding: 6px 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-details:hover {
      background: var(--primary-green);
      color: var(--bg-primary);
      border-color: var(--primary-green);
    }

    .recent-activities {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 40px;
    }

    .recent-activities h2 {
      margin-bottom: 25px;
      color: var(--text-primary);
    }

    .activities-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .activity-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px;
      background: var(--bg-secondary);
      border-radius: 8px;
    }

    .activity-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }

    .activity-icon.easy {
      background: rgba(34, 197, 94, 0.2);
    }

    .activity-icon.medium {
      background: rgba(245, 158, 11, 0.2);
    }

    .activity-icon.hard {
      background: rgba(239, 68, 68, 0.2);
    }

    .activity-main {
      color: var(--text-primary);
      margin-bottom: 5px;
    }

    .challenge-name {
      color: var(--primary-green);
    }

    .activity-meta {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .activity-points {
      color: var(--primary-green);
      font-weight: 600;
    }

    .progress-overview {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      padding: 30px;
    }

    .progress-overview h2 {
      margin-bottom: 25px;
      color: var(--text-primary);
    }

    .progress-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }

    .progress-card {
      background: var(--bg-secondary);
      border-radius: 8px;
      padding: 20px;
    }

    .progress-card h3 {
      margin-bottom: 15px;
      color: var(--text-primary);
    }

    .progress-bar {
      background: var(--bg-primary);
      height: 10px;
      border-radius: 5px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .progress-fill {
      height: 100%;
      border-radius: 5px;
      transition: width 0.5s ease;
    }

    .progress-card.easy .progress-fill {
      background: linear-gradient(90deg, #22c55e, #16a34a);
    }

    .progress-card.medium .progress-fill {
  background: linear-gradient(90deg, #f59e0b, #d97706);
}

.progress-card.hard .progress-fill {
  background: linear-gradient(90deg, #ef4444, #b91c1c);
}

.progress-stats {
  color: var(--text-secondary);
  font-size: 0.9rem;
  text-align: right;
}

.modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.6);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.modal-content {
  background: var(--bg-primary);
  border-radius: 10px;
  width: 90%;
  max-width: 600px;
  padding: 20px;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.modal-header h3 {
  color: var(--text-primary);
  margin: 0;
}

.modal-header .close {
  font-size: 1.5rem;
  cursor: pointer;
  color: var(--text-secondary);
}

.solved-challenge {
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
  border-bottom: 1px solid var(--border-color);
}

.challenge-info {
  color: var(--text-primary);
}

.challenge-timestamp {
  color: var(--text-muted);
  font-size: 0.85rem;
}

.no-data, .no-activities, .no-challenges {
  color: var(--text-muted);
  text-align: center;
  padding: 20px;
}
